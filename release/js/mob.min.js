/*!
 * =====================================================
 * mob v0.1.0 (https://github.com/mobframe/mob)
 * Copyright 2015 Xu, Yizhi
 * Licensed under MIT 
 *
 * v0.1.0 .
 * =====================================================
 */
!function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,$):function(a){if(!a.document)throw new Error("mob requires a window with a document");return b(a,$)}:b(a,$)}("undefined"!=typeof window?window:this,function(a,b){function c(a,c){c=b.extend(!0,{direction:"h",offset:{x:0,y:0},onTransitionEnd:function(){},oninit:function(){},onstart:function(){},onmove:function(){},onend:function(){},onresize:function(){}},c),this.x=c.offset.x,this.y=c.offset.y,this.init(a,c)}var d=function(a){var c=b(a);if(this.$el=b(c.attr("href")||c.data("target")),this.$el.hasClass("aside-push")){this.isPush=!0;var d=this.bindEl=b(this.$el.data("bind"));d.addClass("aside-push-obj").removeClass("aside-push-obj-right").removeClass("aside-push-obj-left").removeClass("aside-push-obj-top").removeClass("aside-push-obj-bottom"),this.$el.hasClass("aside-right")?this.bindClass="aside-push-obj-right":this.$el.hasClass("aside-left")?this.bindClass="aside-push-obj-left":this.$el.hasClass("aside-top")?this.bindClass="aside-push-obj-top":this.$el.hasClass("aside-bottom")&&(this.bindClass="aside-push-obj-bottom"),d.addClass(this.bindClass)}};d.prototype={show:function(){var a=this;this.$el.removeClass("slideout").addClass("show").addClass("slidein"),this._apear(this.$el),this.isPush?this.bindEl.removeClass("slideout").addClass("slidein").one("click",function(){a.hide.call(a)}).on("touchmove",this.bindEl,this._preventMove):this._addBackdrop()},hide:function(){this.$el.removeClass("slidein").addClass("slideout").removeClass("show"),this._disapear(this.$el),this.isPush?this.bindEl.removeClass("slidein").addClass("slideout").off("touchmove",this.bindEl,this._preventMove):this._removeBackdrop()},toggle:function(){this.$el.hasClass("show")?this.hide():this.show()},_disapear:function(a){setTimeout(function(){a.addClass("disapear")},300)},_apear:function(a){a.removeClass("disapear")},_addBackdrop:function(){var a=this;this.$el.after("<div class='aside-backdrop'></div>"),this.$el.siblings(".aside-backdrop").one("click",function(b){b.preventDefault(),b.stopPropagation(),this.remove(),a.hide()})},_removeBackdrop:function(){this.$el.siblings(".aside-backdrop").remove()},_preventMove:function(a){a.preventDefault()}},b.fn.aside=function(a){return this.each(function(){var b=new d(this);"string"==typeof a&&b[a]()})},b(document).on("click.data-api",'[data-aside="toggle"]',function(a){a.preventDefault(),b(this).aside("toggle")});var e=function(a){var c=this;a&&("string"==typeof a?(this.el=a,this.$el=b(this.el)):(this.$el=a.$el||b(a.el),this.confirm=a.confirm),this.$el.find(".btn-confirm").bind("click",function(){c.confirm&&c.confirm.call(c,this)}),this.$el.find(".btn-cancel").bind("click",function(){c.hide()}))};e.prototype={pos:function(){var a=this.$el.find(".modal-dialog");console.log(a),a.css({})},show:function(a){this.showed||(this.pos(),a&&a.msg&&b(".dialog-tip",this.$el).text(a.msg),this.$el.removeClass("hide").addClass("show"),this.showed=!0,b("body").append('<div class="modal-backdrop"></div>'))},hide:function(){this.showed&&(this.$el.removeClass("show").addClass("hide"),b(".modal-backdrop").remove(),this.showed=!1)}},b.fn.modal=function(a){var b=new e(a);return b};var f=function(){for(var a,b=document.createElement("div").style,c="t,webkitT,MozT,msT,OT".split(","),d=0,e=c.length;e>d;d++)if(a=c[d]+"ransform",a in b)return c[d].substr(0,c[d].length-1);return!1}(),g=f?"-"+f.toLowerCase()+"-":"",h=function(a){return""===f?a:(a=a.charAt(0).toUpperCase()+a.substr(1),f+a)},i=h("transitionDuration"),j=h("transform"),k=function(){if(f===!1)return!1;var a={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"oTransitionEnd",ms:"MSTransitionEnd"};return a[f]}();c.prototype={init:function(b,c){this.options=c,this.wrapper="string"==typeof b?document.querySelector(b):b,this.slider=this.wrapper.querySelector(".slider-group"),this.slider.style.cssText="position:relative;top:0;"+g+"transition-duration:0;"+g+"transform: translateZ(0);"+g+"transition-timing-function:ease-out",a.addEventListener("resize",this,!1),this.wrapper.addEventListener("touchstart",this,!1),this.wrapper.addEventListener("touchmove",this,!1),this.wrapper.addEventListener("touchend",this,!1),this.slider.addEventListener(k,this,!1),this.refreshSize(),this.options.oninit()},refreshSize:function(){this.wrapperWidth=this.wrapper.clientWidth,this.wrapperHeight=this.wrapper.clientHeight,this.maxX=this.wrapperWidth-this.slider.offsetWidth,this.maxY=this.wrapperHeight-this.slider.offsetHeight,this.snapThreshold=Math.round(.15*this.wrapperWidth),this.resetPosition(),this.options.onresize()},resetPosition:function(){var a=this.x,b=this.y;"h"==this.directionLocked&&(this.x>0&&(a=0),this.x<this.maxX&&(a=this.maxX)),"v"==this.directionLocked&&(this.y>0&&(b=0),this.y<this.maxY&&(b=this.maxY)),this.slider.style[i]="0ms",this.__pos(a,b)},destroy:function(){a.removeEventListener("resize",this,!1),this.wrapper.removeEventListener("touchstart",this,!1),this.wrapper.removeEventListener("touchmove",this,!1),this.wrapper.removeEventListener("touchend",this,!1),this.slider.removeEventListener(k,this,!1)},handleEvent:function(a){switch(a.type){case"touchstart":this.__start(a);break;case"touchmove":this.__move(a);break;case"touchcancel":case"touchend":this.__end(a);break;case"resize":this.__resize();break;case k:case"otransitionend":this.__transitionEnd()}},__resize:function(){this.refreshSize()},__transitionEnd:function(){this.options.onTransitionEnd()},__pos:function(a,b){this.x=a,b=b||0,this.y=b,this.slider.style[j]="translate("+a+"px,"+b+"px) translateZ(0)"},__start:function(a){if(!this.initiated){var b=a.touches[0];this.initiated=!0,this.moved=!1,this.startX=this.x,this.startY=this.y,this.pointX=b.pageX,this.pointY=b.pageY,this.stepsX=0,this.stepsY=0,this.directionX=0,this.directionY=0,this.directionLocked=!1,this.startTime=(new Date).getTime(),this.slider.style[i]="0s",this.options.onstart()}},__move:function(a){if(this.initiated){var b,c,d=a.touches[0],e=d.pageX-this.pointX,f=d.pageY-this.pointY,g=(new Date).getTime();if(this.directionLocked=this.options.direction,e=Number(e),f=Number(f),this.moved=!0,this.pointX=d.pageX,this.pointY=d.pageY,this.stepsX+=Math.abs(e),this.stepsY+=Math.abs(f),this.directionX=e>0?1:0>e?-1:0,"h"==this.directionLocked?f=0:"v"==this.directionLocked&&(e=0),b=this.x+e,c=this.y+f,!(this.stepsX<10&&this.stepsY<10)){if(!this.directionLocked&&this.stepsY>this.stepsX)return void(this.initiated=!1);if("v"==this.directionLocked&&this.stepsX>50&&this.stepsY<this.stepsX&&this.options.onSwipe)return void this.options.onSwipe(this.directionX);if("h"==this.directionLocked&&this.stepsY>this.stepsX)return void(this.moved=!1);a.preventDefault(),a.stopPropagation(),(b>0||b<this.maxX)&&(b=this.x+e/2),(c>0||c<this.maxY)&&(c=this.y+f/2),this.__pos(b,c),g-this.startTime>300&&(this.startTime=g,this.startX=this.x,this.startY=this.y),this.options.onmove(b,c)}}},momentum:function(a,b,c,d,e,f){var g,h,i=a-b,j=Math.abs(i)/c;return f=void 0===f?6e-4:f,g=a+j*j/(2*f)*(0>i?-1:1),h=j/f,d>g?(g=e?d-e/2.5*(j/8):d,i=Math.abs(g-a),h=i/j):g>0&&(g=e?e/2.5*(j/8):0,i=Math.abs(a)+g,h=i/j),{destination:Math.round(g),duration:h}},__end:function(a){if(this.initiated){var b=(a.changedTouches[0],this.x),c=(new Date).getTime()-this.startTime,d=this.y,e=100*(this.x-this.startX)/this.x;if(durationY=100*(this.y-this.startY)/this.y,this.initiated=!1,this.moved){if(300>c&&(momentumX=this.momentum(this.x,this.startX,c,this.maxX,this.wrapperWidth),momentumY=this.momentum(this.y,this.startY,c,this.maxY,this.wrapperHeight),b=momentumX.destination,e=momentumX.duration,d=momentumY.destination,durationY=momentumY.duration),"h"==this.directionLocked&&(d=0,b>0&&(b=0),b<this.maxX&&(b=this.maxX),b<this.snapThreshold&&(this.slider.style[i]=e+"ms",this.__pos(b,d))),"v"==this.directionLocked&&(b=0,d>0&&(d=0),d<this.maxY&&(d=this.maxY),0==d||d==this.maxY)){this.slider.style[i]=durationY+"ms";var f=this;f.__pos(b,d)}this.options.onend(b,d)}}}};var l=null;b.fn.scrollable=function(a){var b="string"==typeof a,d=[].slice.call(arguments,1);return this.each(function(){return b?l[a].apply(l,d):l=new c(this,a),l})};var m=function(a,d){var e=this;d=b.extend(!0,{current:1,onSlideTo:function(){}},d),this.options=d,this.init(a,d),this.onResize();var f=this.getIndex(),g=-f*this.pageWidth;this.instance=new c(a,{offset:{x:g,y:0},oninit:function(){},onresize:function(){e.onResize.call(e)},onend:function(a,b){e.onEnd.call(e,a,b)},onTransitionEnd:function(){e.onTransitionEnd.call(e)},onmove:function(){}})};m.prototype={init:function(a){if(a="string"==typeof a?document.querySelector(a):a,this.wrapper=a,this.slider=a.querySelector(".slider-group"),this.slideItems=[].slice.call(this.slider.querySelectorAll(".slider-item"),0),this.options.numberOfPages=this.slideItems.length,this.current=this.options.current||1,this.options.loop){var b=this.slideItems[0].cloneNode(!0);b.className=b.className+" slider-repeat",this.slider.appendChild(b),b=this.slideItems[this.options.numberOfPages-1].cloneNode(!0),b.className=b.className+" slider-repeat",this.slider.insertBefore(b,this.slideItems[0])}this.selectIndicator()},onEnd:function(a){if(!this.options.loop&&(this.x>0||this.x<this.maxX)&&(a=0),a&&a<this.snapThreshold){this.slider.style[i]=Math.floor(100*a/this.snapThreshold)+"ms";var b=this.getIndex();return void this.instance.__pos(-b*this.pageWidth)}this.__checkPosition()},getIndex:function(){return this.options.loop?this.current:this.current-1},__checkPosition:function(){var a=this.options.numberOfPages;this.current=this.instance.directionX>0?this.options.loop?(this.current+a)%(a+1):1==this.current?1:this.current-1:this.options.loop?this.current%(a+1)+1:this.current==a?a:this.current+1;var b=this.getIndex();newX=-b*this.pageWidth,this.slider.style[i]=Math.floor(500*Math.abs(this.x-newX)/this.pageWidth)+"ms",this.x==newX||this.instance.__pos(newX),this.selectIndicator(),this.options.onSlideTo.call(this)},selectIndicator:function(){var a=this.wrapper.querySelectorAll(".indicator"),c=this.getIndex();current=a[c],b(this.wrapper).find(".indicator-selected").removeClass("indicator-selected"),b(current).addClass("indicator-selected")},onResize:function(){var a=this.wrapper.clientWidth;this.wrapperWidth=a,this.slider.style.width=a*this.options.numberOfPages+"px",this.slideItems.forEach(function(b){b.style.width=a+"px"});var b=this.options.swipeWith;this.pageWidth=b?/%/.test(b)?Math.round(this.pageWidth*b.replace("%","")/100):b:this.wrapperWidth,this.snapThreshold=null===this.options.snapThreshold?Math.round(.15*this.pageWidth):/%/.test(this.options.snapThreshold)?Math.round(this.pageWidth*this.options.snapThreshold.replace("%","")/100):this.options.snapThreshold},onTransitionEnd:function(){var a=this.options.numberOfPages;(this.current==a+1||0==this.current)&&(this.slider.style[i]="0ms",this.instance.__pos(-this.getIndex()*this.pageWidth))},onSlideTo:function(){},slideTo:function(a){if(a){this.current=a;var b=this,c=this.getIndex();this.onResize(),setTimeout(function(){var a=-1*c*b.pageWidth;b.instance.__pos(a),b.options.onSlideEnd&&b.options.onSlideEnd.call(b)},100)}}};var n=null;b.fn.slide=function(a){var b="string"==typeof a,c=[].slice.call(arguments,1);return this.each(function(){return b?n[a].apply(n,c):n=new m(this,a),l})}});